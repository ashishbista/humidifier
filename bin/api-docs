#!/usr/bin/env ruby

require 'bundler/setup'
require 'humidifier'

File.open('API.md', 'w') do |file|
  file.write("# API Reference\n\n")

  Humidifier.registry.sort.each do |aws_name, clazz|
    file.write("### #{aws_name.gsub('AWS', 'Humidifier')}\n\n")
    clazz.props.sort.each do |name, prop|
      prop_type = prop.class.name.split('::').last.gsub(/Prop\z/, '')
      file.write("* #{name.gsub('_', '\_')} (#{prop.key}: #{prop_type})\n")
    end
    file.write("\n")
  end
end
